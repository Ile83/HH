<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Penetraatiotestaus</title>
<style type="text/css">
   
    body, html
            {
                max-width: 47em;
            }
    body,td,th {
        font-family: "Myriad Pro", "Myriad Pro Bold", Garamond;
    }
    </style>
</head>

<body>
    <h1>Haaga-Helia ammattikorkeakoulu
        </h1>
        <h2>
        Penetraatiotestaus
        </h2>
    <br>
    23.10.2023
    <br>
    <h3>h0 Alkuluento</h3>

    <img src="Graphics/Penetraatiotestaus/1.png" alt="" width="700" height=""/>
    <p>
        200 koodi tarkoittaa, ett√§ pyynt√∂ hyv√§ksyttiin
        <br>
        301 pyydetty osoite on muutettu pusyv√§sti ja uusi osoite on annettu vastautaksessa
        <br>
        jokaisessa k√§ytettiin GET metodia
        <br>
        Domain: osoite mist√§ haetaan tai palautetaan tieto
        <br>
        File: tiedosto joka kyseess√§
        <br>
        L√§hde: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#successful_responses
</p>
<img src="Graphics/Penetraatiotestaus/2.png" alt="" width="700" height=""/>
<p>
Initiator en tied√§ tarkalleen, arvioisin, ett√§ kyseess√§ on alkuper√§inen tiedosto, josta l√§hti haku
Yritin selvitt√§√§ l√§hteest√§ mutta, en ehtinyt. L√§hde: https://firefox-source-docs.mozilla.org/devtools-user/network_monitor/request_details/index.html
</p>
<img src="Graphics/Penetraatiotestaus/3.png" alt="" width="700" height=""/>
<p>
    Esimerkkin√§ viel√§ wiresharkin index.php get metodin koodilla 200 tieto mit√§ tulee palautuksena
</p>
<h1>Haaga-Helia ammattikorkeakoulu
</h1>
<h2>
Penetraatiotestaus
</h2>
<br>
25.10.2023
<br>
<h3 id="Luento1">h1 Hacker Warmup</h3>
    <h3>X) Lue ja tiivist√§: ‚Ç¨ Santos et al: The Art of Hacking (Video Collection): [..] 4.3 Surveying Essential Tools for Active Reconnaissance. Sis√§lt√§√§ porttiskannauksen. 5 videota, yhteens√§ noin 20 min.</h3>
    <li>- K√§ytiin l√§pi eri porttiskannereita Nmap suosituin ja vakain.</li>
    <li>- Eyewitness sovellus, joka luo tiedoston kuvakaappauksin saitista.</li>
    <li>- eri verkkohaavoittuvuus skannereita, maksullisia ja open source</li>
    <li>- eri nettihaavoittuvuus skannereita</li>
    <h3>Hutchins et al 2011: Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains, chapters Abstract, 3.2 Intrusion Kill Chain.</h3>
    <li>- voidaan ker√§t√§ tietoa hy√∂kk√§yksist√§ ja rakentaa sit√§ vastaan suojaa, ett√§ hy√∂kk√§ykset eiv√§t onnistu</li>
    <li>- Advanced persistent threat APT</li>
    <li>- kohteena intellectual property, eli immateriaalisen oikeuden takana olevat asiat, arkaluontoinen data</li>
    <li>- hy√∂kk√§√§j√§t hy√∂dynt√§v√§t muokattua maltsua ja nollap√§iv√§ haavoittuvuuksia</li>
    <li>- Tunkeutuminen voidaan keskeytt√§√§ intteligence driven responsella, eli vastataan siihen omaan tiedusteluun perustuen</li>
    <li>- Tappoketju on systemaattinen prosessi, joka kohdennetaan ja suoritetaan saavuttaakseen halutun lopputuloksen.</li>
    <li>- Hyv√§ksik√§ytt√∂ kohdistuu ohjelmaan, k√§ytt√∂j√§rjestelm√§n haavoittuvuuteen, ty√∂ntekij√§n hyv√§ksik√§ytt√∂√∂n tai ominaisuuteen, joka automattisesti k√§ynnist√§√§ koodin p√§tk√§n</li>
    <li>- Jos vastustajat pystyv√§t havaitsemaan hy√∂kk√§yksen ajoissa ja suojaamaan j√§rjestelm√§√§, he s√§ilytt√§v√§t taktisen edun</li>
    <li>- Hy√∂kk√§yksen tarkoituksen, kyvykkyyden, doktriinin ja operaatio muotojen ymm√§rt√§minen on tarpeen, jotta voidaan muodostaa vastustuskyky hy√∂kk√§ykseen</li>
    <h3>a) Ratkaise Over The Wire: Bandit kolme ensimm√§ist√§ tasoa (0-2).</h3>
    <img src="Graphics/Penetraatiotestaus/4.png" alt="" width="700" height=""/>
<p>P√§√§sin sis√§√§n. L√§hde: ssh --help komento</p>
<img src="Graphics/Penetraatiotestaus/5.png" alt="" width="700" height=""/>
<p>
L√∂ysin salasanan. L√§hde: <a href="https://man7.org/linux/man-pages/man1/cat.1.html">Man pages</a>
</p>
<img src="Graphics/Penetraatiotestaus/6.png" alt="" width="700" height=""/>
<p>
    L√§hde: <a href="https://stackoverflow.com/questions/42187323/how-to-open-a-dashed-filename-using-terminal">Stack Overflow</a>
</p>
<img src="Graphics/Penetraatiotestaus/7.png" alt="" width="700" height=""/>
<p>
    kokeilin cat komentoa ja bash autocompletionia ja sill√§ onnistui
</p>    
<h3>b) Ratkaise Challenge.fi:st√§ yksi teht√§v√§, esim. Challenge.fi 2021 Where was this picture taken, Encoding basics. Tai joku Challenge.fi 2022. (Nimi vaihtui sattuneesta syyst√§, se on nykyisin Next Gen Hack Challenge)</h3>
<img src="Graphics/Penetraatiotestaus/8.png" alt="" width="700" height=""/>
<p>Valitsin Encoding basics. Tajusin, ett√§ se on Base64 formaatissa ja hain base64decode.orgin googlella ja kokeilin. En k√§ytt√§nyt yht√§√§n vihjett√§. Flagi ratkesi heti</p>
<h3>c) Ratkaise PortSwigger Labs: Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data. (Edellytt√§√§ ilmaista rekister√∂itymist√§. Teht√§v√§n voi ratkaista pelk√§st√§√§n selaimen osoitekentt√§√§ muokkaamalla.)</h3>
<img src="Graphics/Penetraatiotestaus/9.png" alt="" width="700" height=""/>
<p>Muokkasin osoitekentt√§√§, tajusin suurinpiirtein mit√§ tein, mutta t√§lle on varmasti hienompi tapa ja toteutus. En olisi itse keksinyt injektion koodia, ellei se olisi lukenut labiss√§</p>
<h3>d) Asenna Linux virtuaalikoneeseen. Suosittelen joko Kali (viimeisin versio) tai Debian 12-Bookworm.</h3>
<p>
    P√§√§tin k√§ytt√§√§ melkein puhdasta konetta, jonka olin asentanut aikaisemmin Linux kurssin koetta varten, Apache ainakin on siin√§ valmiina asennettuna.
<br>
Kali linuxin olin my√∂s asentanut jo aiemmin, siin√§ olen ajanut sudo apt-get update ja upgrade komennot, vastaan tuli kyll√§ sen verta kryptist√§ asiaa, ett√§ en ole varma olisiko kannattanut k√§ytt√§√§ upgrade komentoa. Ei ollut aikaa perehty√§ ilmoituksiin joita tuli asennuksen aikana.
</p>
<h3>f) Porttiskannaa kaikki koneesi (localhost) tcp-portit. Analysoi tulokset. (Edellisiss√§ kohdissa mainittuja analyyseja ei tarvitse toistaa, voit vain viitata niihin ja keskitty√§ eroihin).</h3>
<img src="Graphics/Penetraatiotestaus/10.png" alt="" width="700" height=""/>
<p>
Asensin porttiskanneri nmapin ja skannasin localhostin, n√§kyy kellonaika, joka on GMT 0 ajassa, en tied√§ mit√§ BST tarkoittaa mutta kello on kaksituntia j√§ljess√§. Olen asentanut virtuaalikoneen ollessani Lontoossa, en tied√§ onko t√§ll√§ vaikutusta k√§ytt√∂j√§rjestelm√§n kelloon. Tarkstelen sit√§ my√∂hemmin.
<br>
Local hostosoitteessa 127.0.0.1 latenssi oli 0.00063s, eli kone on todella l√§hell√§. Ja niin on syyt√§kin olla koska se on vieress√§ni, eik√§ v√§liss√§ ole esim valokaapelia. latenssista voi hieman p√§√§tell√§ kuinka pitk√§ll√§ kone sijaitsee.
<br>
Ilmeisesti yksi portti ei skannautunut kohdassa Other addresses for localhost (not scanned)
<br>
Listassa ei n√§ytet√§ kiinni olevia portteja 997 kpl niihin ei saatu yhteytt√§.
portti 25/tcp, 80/tcp, 631/tcp ovat auki. Ensimm√§inen viittaa s√§hk√∂postin l√§hetys palvelimeen, seuraava verkkosivuihin ja viimeinen on internet printing protokollan portti 
</p>
<h3>g) Tee laaja porttiskanaus (nmap -A) omalle koneellesi (localhost), kaikki portit. Selit√§, mit√§ -A tekee. Analysoi tulokset. (Edellisiss√§ kohdissa mainittuja analyyseja ei tarvitse toistaa, voit vain viitata niihin ja keskitty√§ eroihin.).</h3>
<img src="Graphics/Penetraatiotestaus/11.png" alt="" width="700" height=""/>
<li>Portti 25 ssl certifikaatti n√§ytt√§isi paljastavan, ett√§ k√§yt√∂ss√§ on Debian k√§ytt√∂j√§rjestelm√§, en tied√§ mit√§ organizationName=Exim tarkoittaa? Sitten taas viitataan UK:hon, saattaa johtua, ett√§ asensensin virtuaalikoneeni ollessani lontoossa.</li>
<li>Sertifikaattion alkamis ja loppumis pvm. ja kellonajat. tosin en ihan ymm√§rr√§ noita vuosia ja p√§ivi√§.</li>
<li>Ssl-date TLS randomness does not represent time, selitt√§√§k√∂ t√§m√§ sitten tuon ylemm√§n.</li>
<li>80 portissa py√∂rii Apache palvelin versio numerolla 2.4.57 ja Debian k√§yttt√∂j√§rjestelm√§ll√§ n√§ytt√§en default sivua ja se toimii tekstill√§</li>
<li>631 portissa py√∂rii palvelu CUPS 2.4 liittyy siis tulostamiseen, en osaa muuta sanoa. Luulisin, ett√§ tuo robots.txt on suojattu ja siihen ei p√§√§ssyt k√§siksi</li>
<li>Yksi ip osite skannatiin ja siihen kului 8.81 sekuntia.</li>
<h3>h) Asenna ja k√§ynnist√§ jokin palvelin (apache, ssh...) koneellesi. Vertaile, miten porttiskannauksen tulos eroaa.</h3>
<p>
Minulla n√§k√∂√§j√§√§n oli koneella jo apache py√∂rim√§ss√§, joten suljin sen t√§t√§ teht√§v√§√§ varten komennolla ‚Äùsudo systemctl stop apache2‚Äù
<br>
sitten tein uudestaan laaja porttiskannauksen
</p>
<img src="Graphics/Penetraatiotestaus/12.png" alt="" width="700" height=""/>
<p>
    Nyt portti 80 ei n√§y skannatuissa porteissa, kun siin√§ ei siis py√∂ri en√§√§ palvelinta.
</p>
<h3>i) Kokeile ja esittele jokin avointen l√§hteiden tiedusteluun sopiva weppisivu tai ty√∂kalu. Hyvi√§ esimerkkej√§ l√∂ytyy Bazzel: IntelTechniques: Tools ja Bellingcat: Resources, voit my√∂s k√§ytt√§√§ muuta itse valitsemaasi ty√∂kalua. Ty√∂kalua pit√§√§ siis my√∂s kokeilla, pelkk√§ nimen mainitseminen ei riit√§. Pid√§ esimerkit harmittomina, √§l√§ julkaise kenenk√§√§n henkil√∂kohtaisia salaisuuksia raportissasi.</h3>
<img src="Graphics/Penetraatiotestaus/13.png" alt="" width="700" height=""/>
<p>
    Laitoin kuvan, jonka otin tuosta l√§hteen artikkelista, ja laitoin sen Bingiin. Tuloksena oli kuvalle v√§√§r√§t koordinaati, mutta eri kuin mit√§ Bellincatin artikkelin kirjoittaja oli saanut. Ei n√§ihin kyll√§ viel√§ ole luottamista.
<br>
L√§hde: <a href="https://www.bellingcat.com/resources/2023/07/14/can-ai-chatbots-be-used-for-geolocation/">Bellingcat Geolocation</a>
</p>
<p>
Raportin l√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h1-hacker-warmup">Terokarvinen.com</a>
</p>
<h1>Haaga-Helia ammattikorkeakoulu
</h1>
<h2>
Penetraatiotestaus
</h2>
<br>
04.11.2023
<br>
<h3 id="Luento2">h2 Sniff-n-scan</h3>
<p>
    tutustuttaa uuteen l√§hteeseen, hakkeritapahtumien nauhoihin. Opit valvomaan hy√∂kk√§ysty√∂kalujen toimintaa snifferill√§, ja tutustut Wiresharkiin. Wireshark osaa my√∂s analysoida paketit automaattisesti. Weppiin murtautumista auttaa suomalainen, fuzzereiden huipulle noussut ffuf. Harjoitusmaalien asentamisesta kokeillaan paikallisia bin√§√§rej√§ (by yours truly) ja Dockeria.
</p>
<h4>x) Lue/katso ja tiivist√§. (T√§ss√§ x-alakohdassa ei tarvitse tehd√§ testej√§ tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelm√§ riitt√§√§. Tiivist√§miseen riitt√§√§ muutama ranskalainen viiva.)   
</h4>
<h4>Hoikkala "joohoi" 2020: <a href="https://www.youtube.com/watch?v=mbmsT3AhwWU"> Fuzzing Faster (U fool).</a> In HelSec Virtual meetup #1. (about 1 hour)</h4>
<li>Joona Hoikkala</li>
<li>Burbsuiten voi yhist√§√§</li>
<li>FUZZ on t√§rke√§ komennossa</li>
<li>Useita ominaisuuksia</li>
<h4>Lyon 2009: Nmap Network Scanning: Chapter 15. Nmap Reference Guide:
    <a href="https://nmap.org/book/man-port-scanning-basics.html">PortScanning Basics</a>(opettele, mit√§ tarkoittavat: open, closed, filtered; muuten vain silm√§ily)
    </h4>
    <li>- Open: avoin portti, n√§it√§ hy√∂kk√§√§j√§t etsiv√§t, tapa p√§√§st√§ sis√§√§n. Adminien kannattaisi sulkea tai turvata tulimuurilla. N√§ist√§ saa my√∂s selville mitk√§ palvelut ovat auki verkkoon.</li>
    <li>- Closed: portti on k√§ytett√§viss√§ mutta siin√§ ei py√∂ri mik√§√§n sovellus, joka kuuntelee. Voi olla hy√∂dyllinen toteamaan, ett√§ is√§nt√§ kone on ylh√§√§ll√§. kannattaa mahdollisesti skannata uudelleen, jos vaikka porttiin ilmaantuisi jotain kuuntelemaan.</li>
    <li>- Filtered: Nmap ei osaa p√§√§tell√§ onko portti auki vai kiinni erilaisten syiden takia. filtered porteista ei saa paljon tietoa, hidastaa skannausta todella paljon.</li>
<h4><a href="https://nmap.org/book/man-port-scanning-techniques.html">Port Scanning Techniques </a> (opettele, mit√§ ovat: -sS -sT -sU; muuten vain silm√§ily.</h4>
<li>- sS (TCP SYN scan): perusskannaus, skannaa tuhansia portteja sekunneissa, ei tunkeutuva ja hyvin suojassa pysyv√§ skannaus. Ei muodosta valmiita TCP yhteyksi√§. ns. puolijulkinen skannaus. Jakaa skannaukset selke√§sti open, closed ja filtered tiloihin.TCP, SYN paketti odotus, A SYN/ACK, RST</li>
<li>- sT (TCP connect scan): K√§ytet√§√§n perusskannauksena, kun TCP SYN scan ei k√§y kyseeseen. Johtuu siit√§, jos k√§ytt√§j√§ll√§ ei ole rakaa pakettidata oikeuksia (Sudo?) SYN scan on useimmiten parempi vaihtoehto, jos sit√§ voi k√§ytt√§√§. Connect scan luo TCP yhteyden ja todenn√§k√∂isemmin j√§tt√§√§ j√§ljen lokiin.</li>
<li>- sU (UDP scans): UDP Skannaus, UDP palvelut joita py√∂ritet√§√§n. DNS, SNMP, and DHCP (rekister√∂idyt portit 53, 161/162, ja 67/68) ovat yleisimm√§t. Porttiskannus hidasta, kaikkien porttien skannaus voi vied√§ jopa 18 tuntia, kanttaa usein skannata tavanomaisimmat portit ja py√∂ritt√§√§ useita skannauksia rinnakkain. Portit ovat erinomaisia tunkeutujille, koska tietoturvasta vastaavat j√§tt√§v√§t usein portit huomioimatta. Voidaan yhdist√§√§ SYN skannaukseen samanaikaisesti.</li>
<h4>a) Fuff. Ratkaise <a href="https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/?fromSearch=ffuf#your-turn---challenge">Teron ffuf-haastebin√§√§ri.</a> Artikkelista <a href="https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/">Find Hidden Web Directories - Fuzz URLs with ffuf</a>voi olla apua.</h4>
<img src="Graphics/Penetraatiotestaus/14.png" alt="" width="700" height=""/>
<p>komento ‚Äúsudo apt-install wget‚Äù 
    <br>
    komento‚Äù wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-1‚Äù
    </p>
    <img src="Graphics/Penetraatiotestaus/15.png" alt="" width="700" height=""/>
    <p>komento ‚Äúchmod u+x dirfuzt-1‚Äù, harjoitusmaalin k√§ynnistys ‚Äù./dirfuzt-1‚Äù, ja avaus Firefoxilla, harjoitusmaali on k√§ynniss√§.
        <br>
        hain wgetill√§ fuzzin teron ohjeiden mukaan ja latasin common.txt
        <br>
        ‚Äù./ffuf -w common.txt -u http:/127.0.0.2:8000/FUZZ‚Äù
        </p>
        <img src="Graphics/Penetraatiotestaus/16.png" alt="" width="700" height=""/>
    <p>
        Harjoitusmaali oli alhaalla, nostin sen pystyyn komennolla ‚Äù./dirfuz-1‚Äù ja kokeilen uudestaan.
    </p>
    <img src="Graphics/Penetraatiotestaus/17.png" alt="" width="700" height=""/>
    <p>Onnistui, mutta pit√§isi filtter√∂id√§</p>
    <img src="Graphics/Penetraatiotestaus/18.png" alt="" width="700" height=""/>
    <p>komento ‚Äù ./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154‚Äù
        palautti t√§m√§n n√§lkoisen tulosteen, t√§ss√§ n√§kyy kaikki mik√§ j√§i filter√∂innin j√§lkeen, fillter√∂in siis tiedosto koon mukaan (154 tavuiset tiedostot pois tuloksista). Ja onhan siell√§ wordressiin admin, k√§vin selaimella osoitteessa ja lippu l√∂ytyi.
        </p>
<h4>b) Fuffme. Asenna Ffufme harjoitusmaali paikallisesti omalle koneellesi. Ratkaise teht√§v√§t (kaikki paitsi ei "Content Discovery - Pipes")</h4>
<p>
- Valitetavasti en tajunnut tehd√§ t√§t√§. En ymm√§rt√§nyt, ett√§ ffufme oli linkki, koska olin kopioinut teht√§v√§n tekstieditoriin.
</p>
        <h4>
            Porttiskannaa paikallinen kone (127.0.0.2 tms), sieppaa liikenne snifferill√§, analysoi.
            En l√∂yd√§ Wiresharkin tiedoista oikeita paketteja ‚òπ
        </h4>
            <h4>c) nmap TCP connect scan -sT</h4>
            <img src="Graphics/Penetraatiotestaus/19.png" alt="" width="700" height=""/>
<p>
    Komento ‚Äùnmap -sT 127.0.0.2‚Äù
    <br>
En saanut wiresharkilla skannattua liikennett√§ tuosta. Se n√§ytt√§√§ kyll√§ verkossa olevaa muuta liikennett√§. Minulla on virtuaalikoneesta katkaistu nettiyhteys. En kyll√§ ymm√§rr√§ miten Wireshark n√§ytt√§√§ muuta verkkoliikennett√§ silti. Idea connected scannissa on, ett√§ se luo kuitenkin TCP yhteyden ja on n√§in ollen helpommin havaittavissa lokista.
<br>
Yht√§√§n porttia ei ole koneessa auki.
<br>
Jatkan teht√§vien tekoa ilman Wiresharkkia, en tied√§ miss√§ siin√§ on vika. Dataa tulee paljon, mutta en l√∂yd√§ sielt√§ oikee, voi toki olla user error üòä
</p>
<h4>d) nmap TCP SYN "used to be stealth" scan, -sS (t√§t√§ k√§ytet√§√§n skannatessa useimmin)</h4>
<img src="Graphics/Penetraatiotestaus/20.png" alt="" width="700" height=""/>
<p>
    komento ‚Äùnmap -sS locahost‚Äù tarvitsee Super user do oikeudet, niin kuin arvelinkin aikaisemmassa teht√§v√§ss√§. Kokeilen sudolla.
</p>
<img src="Graphics/Penetraatiotestaus/21.png" alt="" width="700" height=""/>
<p>
    komento ‚Äùsudo nmap -sS 127.0.0.2‚Äù
    <br>
    komenonnon ero on se, ett√§ t√§t√§ ei pysty niin helposti havaitsemaan, kun t√§m√§ ei muodosta t√§ytt√§ TCP yhteytt√§ vaan droppaa yhteyden havaitessaan, jos portti vastaa. Ei j√§t√§ lokiin j√§lke√§. En saanut t√§t√§k√§√§n Wiresharkilla kaapattua.
</p>
<h4>e) nmap ping sweep -sn</h4>
<img src="Graphics/Penetraatiotestaus/22.png" alt="" width="700" height=""/>
<p>
    -sn j√§tt√§√§ porttiskannauksen pois, luulisin, ett√§ t√§ll√§ voi p√§√§tell√§ onko tietokone p√§√§ll√§ ja j√§tt√§√§ v√§hemm√§n j√§lki√§.
</p>
<h4>f) nmap don't ping -Pn</h4>
<img src="Graphics/Penetraatiotestaus/23.png" alt="" width="700" height=""/>
<p>Kohtele kaikkia koneita kun ne olisivat p√§√§ll√§, skippaa host l√∂yt√§minen. L√§hde Man-Pages ‚Äùman nmap‚Äù</p>
<h4>g) nmap version detection -sV (esimerkki yhdest√§ palvelusta yhdess√§ portissa riitt√§√§)</h4>
<p>
    Avasin portin 80 komennolla ‚Äúsudo ufw allow 80/tcp‚Äù
    <br>
Netti p√§√§lle koneesta
<br>
komento ‚Äùsudo apt-get install apache2‚Äù
</p>
<img src="Graphics/Penetraatiotestaus/24.png" alt="" width="700" height=""/>
<p>komento ‚Äúfirefox localhost‚Äù Apache py√∂rii koneella</p>
<img src="Graphics/Penetraatiotestaus/25.png" alt="" width="700" height=""/>
<p>komento ‚Äúnmap -sV 127.0.0.2‚Äù N√§ytt√§isi tunnistavan debianin sielt√§ ja apachen versio numeron</p>
<h4>h) nmap output files -oA foo. Milt√§ tiedostot n√§ytt√§v√§t? Mihin kukin tiedostotyyppi sopii? </h4>
<img src="Graphics/Penetraatiotestaus/26.png" alt="" width="700" height=""/>
<p>L√§hde: Man pages ‚Äùman nmap‚Äù
    <br>
    En saa toimimaan, pit√§isi n√§ytt√§√§ kolme ilmeisesti eniten k√§yt√∂ss√§ olevaa tiedosto tyyppi√§. Ovatko n√§m√§ .gmnmap, .nmap ja .xml
</p>
<h4>nmap ajonaikaiset toiminnot (man nmap: runtime interaction): verbosity v/V, help ?, packet tracing p/P, status s (ja moni muu nappi)</h4>
<li>-v Verbosity level nostaa tulostettavan tiedon m√§√§r√§√§ skannauksen aikana.</li>
<li>-help antaa pika opaan nmapin k√§ytt√∂√∂n. Ei niin kattava kun man nmap</li>
<li>-p Skannaa vain haluamasi porttiavaruus L√§hde:  Man pages ‚Äùman nmap‚Äù</li>
<li>-s Spooffaa ip osoitteen, t√§m√§ saattaa olla minun tapauksessani kysess√§. Kun Wiresharkilla en saanut tietoa sniffauksesta. Nmap kertoi, ett√§ couldn‚Äôt resolve dns. viittaisi siihen. kokeilen my√∂hemmin. L√§hde: Man Pages ‚Äùman nmap‚Äù</li>
<h4>j) Ninjojen tapaan. Piiloutuuko nmap-skannaus hyvin palvelimelta? Vinkkej√§: Asenna Apache. Aja nmap-versioskannaus -sV tai -A omaan paikalliseen weppipalvelimeen. Etsi Apachen lokista t√§t√§ koskevat rivit. Wiresharkissa "http" on k√§tev√§ filtteri, se tulee siihen yl√§reunan "Apply a display filter..." -kentt√§√§n. Nmap-ajon aikana p laittaa packet tracing p√§√§lle. Vapaaehtoinen lis√§kohta: j√§√§k√∂ Apachen lokiin jokin todiste nmap-versioskannauksesta?</h4>
<p>
    kokeilin ‚Äùnmap -s -sV localhost‚Äù eip√§ toiminut edelleen varoitus unable to detemine any DNS servers. Reverse DNS is disabled. Veikkaukseni taisi olla v√§√§r√§. tuota -s k√§ytet√§√§n yleisemmin muiden skannausten yhteydess√§ nmap kertoi.
</p>
<img src="Graphics/Penetraatiotestaus/27.png" alt="" width="700" height=""/>
<p>
    Kokeilin ilman tuota -s eli komento ‚Äù nmap -sV localhost‚Äù ja katsoin apachen Acces.login. J√§lki√§ ei tuosta -sV:st√§ j√§√§nyt muista localhostin skannauksista oli kuitenkin j√§√§nyt.
</p>
<h4> k) UDP-skannaus. UDP-skannaa paikkalinen kone (-sU). "Mulla olis vitsi UDP:sta, mutta en tied√§ menisik√∂ se perille":
    </h4>
    <img src="Graphics/Penetraatiotestaus/28.png" alt="" width="700" height=""/>
    <p>
        Kaksi porttia auki open | filtered tilassa
    </p>
    <h4>l) Miksi UDP-skannaus on hankalaa ja ep√§luotettavaa? Miksi UDP-skannauksen kanssa kannattaa k√§ytt√§√§ --reason flagia ja snifferi√§? (t√§ss√§ alakohdassa vain vastaus viitteineen, ei tarvita testi√§ tietokoneella)</h4>
    <p>
        Porttiskannaus olisi teht√§v√§ nopeasti, auki olevat portit ja filtered portit harvoin l√§hett√§v√§t mit√§√§n vastausta, joka saa NMAPIN aikasulkeutumaan ja uudestaan l√§hett√§m√§√§n kyselyn varmuuden vuoksi, jos luotain tai vastaus vaikka katosi. useat is√§nn√§t rajoittavat ICMP porttien vastaus m√§√§r√§√§, kuten LINUX ja SOLARIS jotka ovat eritt√§in tiukkoja t√§ss√§. esimerkiksi LINUX 2.4.20 kerneli rajoittaa ei perille menneiden viestien m√§√§r√§√§ yhteen sekunnissa. T√§m√§ tekee UDP Skannauksesta hidasta. 
        <br>
        L√§hde: <a href="https://nmap.org/book/man-port-scanning-techniques.html">Port Scanning Techniques | Nmap Network Scanning</a> 
        <br>
        --reason flagia kannattaa k√§ytt√§√§, ett√§ saa tiet√§√§ skannattujen porttien tilan. (open, closed, filtered) L√§hde: <a href="http://www.chat.openai.com/">Chat-GPT</a>
        <br>
        Olettaisi, ett√§ snifferill√§, kuten Wireshark saa enemm√§n tietoa, portista, kun mit√§ nmap antaa. En kyll√§ osaa viel√§ tulkita Wiresharkin tietoja.
    </p>
    <p>
        06.11.2023, lis√§huomio, sain Wiresharkin toimimaan, kun valitsin sniffattavaksi adapteriksi ANY, nyt n√§ytt√§√§ yhteydet, jos tekee porttiskannauksen.
    </p>
    L√§hteen√§ raportissa on k√§ytetty <a href="https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h2-sniff-n-scan">Hacking 2023 - Tunkeutumistestaus ict4tn027-3012 loppusyksy online (terokarvinen.com)</a>
    <h1>Haaga-Helia ammattikorkeakoulu
    </h1>
    <h2>
    Penetraatiotestaus
    </h2>
    <br>
    12.11.2023
    <br>
    <h3 id="Luento3">h3 Lab-kid</h3>
   <h3>a) Asenna Kali virtuaalikoneeseen
     , b) Asenna Metasploitable 2 virtuaalikoneeseen
     ja c) Tee koneille virtuaaliverkko, jossa (1) Kali saa yhteyden Internettiin, mutta sen voi laittaa pois p√§√§lt√§
    (2) Kalin ja Metasploitablen v√§lill√§ on host-only network, niin ett√§ porttiskannatessa ym. koneet on eristetty intenetist√§, mutta ne saavat yhteyden toisiinsa
    (3)	Osoita eri komennoilla, ett√§ Internet-yhteys katkeaa: 'ping 1.1.1.1', 'ping www.google.com', 'curl www.google.com'
    </h3>
    <p>
        
Latasin Metasploitable 2 VMware valmiin koneen oheiselta sivustolta <a href="https://docs.rapid7.com/metasploit/metasploitable-2/">Metasploitable 2 | Metasploit Documentation (rapid7.com)</a> 

    </p>
    <p>
        Seurasin videon ohjeita, miten metasploitable asennetaan omaan verkkoon Vmwaressa Kalin kanssa <a href="https://www.youtube.com/watch?v=Jgiv88_pBbU">(347) Metasploitable and kali setup in vmware on private network - YouTube</a>
    </p>
    <img src="Graphics/Penetraatiotestaus/29.png" alt="" width="700" height=""/>
    <p>
        Loin uuden virtuaalisen verkon VMnet2 host-only j poistin valinnan connect a host virtual adapter to this network DHCP palvelun j√§tin p√§√§lle.
    </p>
    <img src="Graphics/Penetraatiotestaus/30.png" alt="" width="700" height=""/>
    <p>
        Laitoin metasploitablen network 2 adapterin kiinni tuohon juuri luotuun virtuaaliseen VMnet2 verkkoon. Laitoin viel√§ kuvasta poiketen varmuuden vuoksi Network adapter (1) NAT valinnan tilaan Host-only: A private network shared with the host.
    </p>
    <p>
        Kalin koneen asetuksissa : 
    </p>
    <img src="Graphics/Penetraatiotestaus/31.png" alt="" width="700" height=""/>
    <p>
        Tein samat muutokse, my√∂s kuvasta poiketen network adapter (1) NAT valinta muotoon Host-Only.
<br>        
Nyt k√§sitt√§√§kseni koneet pit√§isi olla kytketty pois internetist√§, mutta niiden v√§lill√§ on verkkoyhteys.
<br>
ja testaaamaan. Kalin internetin saa p√§√§lle vaihtamalla Network adapterin NAT valinnan p√§√§lle. Kokeilin t√§t√§ Kalin asennus vaiheessa ja se toimi.
</p>
<img src="Graphics/Penetraatiotestaus/32.png" alt="" width="700" height=""/>
<p>
    Kali k√§ytt√∂j√§rjestelm√§n testi Firefoxilla google.comiin 
</p>
<img src="Graphics/Penetraatiotestaus/33.png" alt="" width="700" height=""/>
<p>
    ja viel√§ ping komento, Kali linux ei saa yhteytt√§ internettiin
</p>
<img src="Graphics/Penetraatiotestaus/34.png" alt="" width="700" height=""/>
<p>
    Metasploitablessa komento ‚Äùifconfig‚Äù saa selville ip osoitteen, joka on 192.168.159.130
</p>
<img src="Graphics/Penetraatiotestaus/35.png" alt="" width="700" height=""/>
<p>
    Kalista k√§sin Pingasin 192.168.159.130 joka on metaspoloitablen osoite ja se vastaa, verkko siis toimii. packet loss 0% ja latenssi olematon, joten se siis on l√§hiverkossa oleva kone.
</p>
<h3>d) Etsi Metasploitable porttiskannaamalla (db_nmap -sn). Tarkista selaimella, ett√§ l√∂ysit oikean IP:n - Metasploitablen weppipalvelimen etusivulla lukee Metasploitable. Katso, ettei skannauspaketteja vuoda Internetiin - kannattaa irrottaa koneet netist√§ skannatessa.</h3>
<img src="Graphics/Penetraatiotestaus/36.png" alt="" width="700" height=""/>
<p>
    Testi kali j√§rjestelm√§ll√§, kun network adapter 1 on NAT asennossa ja netti toimii.
</p>
<img src="Graphics/Penetraatiotestaus/37.png" alt="" width="700" height=""/>
<p>
    NAT asetus pois p√§√§lt√§ ja Host-only asentoon virtuaalikoneen asetuksista ja viel√§ testi, ett√§ netti ei toimi mutta metasploitable vastaa.
komento ‚Äùnmap  -sn 192.168.159.130‚Äù

</p>
<img src="Graphics/Penetraatiotestaus/38.png" alt="" width="700" height=""/>
<p>
    Menin ip osoitteeseen ja sielt√§ aukesi metasploitablen weppi palvelin  
</p>
<img src="Graphics/Penetraatiotestaus/39.png" alt="" width="700" height=""/>
<img src="Graphics/Penetraatiotestaus/40.png" alt="" width="700" height=""/>
<p>
portti 21/tcp auki, ftp ei en√§√§ turvallinen tapa
<br>
portti 22/tcp ssh portti auki, en tied√§ onko tavallista, ett√§ tuossa n√§kyy nuo ssh-hostkey:t n√§kyvill√§. Olisiko niill√§ mahdollista saada kone haltuun?
<br>
portti 23/tcp telnet auki. Onko t√§m√§kin vanhentunut tapa?
<br>
portti 25/tcp smtp s√§hk√∂postipalvelimen l√§hetys portti. en osaa sanoa, kuinka haavoittuvainen t√§m√§ on
<br>
53/tcp en tied√§ mik√§ on
<br>
80/tcp weppi palvelin ja siell√§ py√∂rii se metasploitablen nettisivu.
<br>
111/tcp en tied√§ mik√§ on
<br>
139/tcp Samba jako Workgroup, sanoisin, ett√§ haavoittuvainen, vaikuttaa windows jaolta 
<br>
445/tcp Sama Samba tekniikkalla tuotettu jako mutta nyt visiin Linux puolelle, en osaa tarkasti sanoa.
<br>
512- 2121 ei tietoa
<br>
3306/tcp jonkin n√§k√∂inen mySql tietokanta, versionumeron perusteella voi katsoa haavoittuvuudet.
<br>
3632/tcp ei tietoa
<br>
3432/tcp posgresql tietokanta
<br>
6000/tcp ei tietoa
<br>
6667 irc serveri
<br>
6697 irc
<br>
8009-8180 liittyisik√∂ java ohjelmointiin olisiko devaus palvelin.
</p>
<h3>f) Murtaudu Metasploitablen VsFtpd-palveluun Metasploitilla (search vsftpd, use 0, set RHOSTS - varmista osoite huolella, exploit, id)</h3>
<p>
    ensimm√§inen artikkeli ei avautunut minulle aluksi niin k√§ytin n√§it√∂ ohjeita <a href="https://www.stationx.net/how-to-use-metasploit-in-kali-linux/">How to Use Metasploit in Kali Linux: A Step-By-Step Tutorial (stationx.net)</a>
<br>
Metasploit k√§yntiin ohjeiden avulla
</p>
<img src="Graphics/Penetraatiotestaus/41.png" alt="" width="700" height=""/>
<p>
    toisessa terminaalissa komento ‚Äúsudo service postgresql start‚Äù
</p>
<img src="Graphics/Penetraatiotestaus/42.png" alt="" width="700" height=""/>
<p>
    Komento ‚Äúdb_status‚Äù nyt pit√§isi olla yhdistetty tietokantaan.  
</p>
<img src="Graphics/Penetraatiotestaus/43.png" alt="" width="700" height=""/>
<p>
    Loin Workspacen kyseiselle hy√∂kk√§ykselle komennolla ‚Äùworkspace -a metasploitable2vsftpd‚Äù
sitten komento ‚Äùworkspace metasploitable2vsftpd‚Äù siirryin workspaceen

</p>
<img src="Graphics/Penetraatiotestaus/44.png" alt="" width="700" height=""/>
<p>Laitoin komennon ‚Äúsearch vsftpd‚Äù ja ‚Äùuse 1‚Äù koska siell√§ luki backdoor, ajattelin sen olevan sopiva ja rank oli execellent</p>
<img src="Graphics/Penetraatiotestaus/45.png" alt="" width="700" height=""/>
<p>
    asetin rhosti eli kohde osoitteen ja lhostin eli hy√∂kk√§√§v√§n osoitteen, en tied√§ menik√∂ se l√§pi, osoite oli kuitenkin kali k√§ytt√∂j√§rjestelm√§n ip. Laitoin komennon ‚Äùexploit‚Äù ja ilmeisesti p√§√§sin sis√§√§n mutta shelli oli viel√§ huono. 
</p>
<img src="Graphics/Penetraatiotestaus/46.png" alt="" width="700" height=""/>
<p>
    Todisteet viel√§, ajoin ‚Äùls‚Äù komennon ja n√§en palvelimen tiedosto rakenteen.
</p>
<h3>g) Parempi sessio. Tee vsftpd-hy√∂kk√§yksest√§ saadusta sessiosta parempi. (Voit esimerkiksi p√§ivitt√§√§ sen meterpreter-sessioksi, laittaa tty:n toimimaan tai tehd√§ uuden k√§ytt√§j√§n ja ottaa yhteyden jollain tavallisella protokollalla)</h3>
<p>
    aika loppui kesken 0.41 Sunnuntai... pit√§√§ nukkua
</p>
<h3>h) Etsi, tutki ja kuvaile jokin hy√∂kk√§ys ExploitDB:sta. (T√§ss√§ harjoitusteht√§v√§ss√§ pit√§√§ hakea ja kuvailla hy√∂kk√§ys, itse hy√∂kk√§√§minen j√§√§ vapaaehtoiseksi lis√§teht√§v√§ksi)</h3>
<h3>i) Etsi, tutki ja kuvaile hy√∂kk√§ys 'searchsploit' -komennolla. Muista p√§ivitt√§√§. (T√§ss√§ harjoitusteht√§v√§ss√§ pit√§√§ hakea ja kuvailla hy√∂kk√§ys, itse hy√∂kk√§√§minen j√§√§ vapaaehtoiseksi lis√§teht√§v√§ksi. Valitse eri hy√∂kk√§ys kuin edellisess√§ kohdassa.)</h3>
<h3>j) Kokeile vapaavalintaista haavoittuvuusskanneria johonkin Metasploitablen palveluun. (Esim. nikto, wpscan, openvas, nessus, nucleus tai joku muu)</h3>
<h3>k) Kokeile jotain itsellesi uutta ty√∂kalua, joka mainittiin x-kohdan l√§pik√§velyohjeessa.</h3>
</body>
</html>
