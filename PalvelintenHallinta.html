<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Palvelinten Hallinta</title>
<style type="text/css">
   
    body, html
            {
                max-width: 47em;
            }
    body,td,th {
        font-family: "Myriad Pro", "Myriad Pro Bold", Garamond;
    }
    </style>
</head>

<body>
    <h1>Haaga-Helia ammattikorkeakoulu
        </h1>
        <h2>
        Palvelinten Hallinta
        </h2>
    <br>
   27.10.2023
    <br>
    <h4 id="Luento1">h1 Viisikko</h4>
    <h3>x) Lue ja tiivist√§. (T√§ss√§ x-alakohdassa ei tarvitse tehd√§ testej√§ tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelm√§ riitt√§√§. Tiivist√§miseen riitt√§√§ muutama ranskalainen viiva.)</h3>
     
        Karvinen 2023: Create a Web Page Using Github
        <p>
            <li>Rekister√∂idy Githubiin</li>
            <li>Luo uusi repositorio, Lis√§√§ readme.me tekstitiedosto</li>
            <li>Lis√§√§ .md tiedosto</li>
            <li>Kirjoita tekstia ja tallenna</li>
            <li>Sivusi on julkaistu</li>
        </p>
        Karvinen 2023: Run Salt Command Locally
        <p>
            <li>Salt:ia k√§ytet√§√§n normaalisti hallitsemaan isoja m√§√§ri√§ orjatietokoneita verkossa</li>
            <li>Samat toiminnot toimivat niin Linux kuin Windowssissa</li>
            <li>Kaikista t√§rkeimm√§t komennot ovat pkg, file, service, user and cmd.</li>
        </p>




    <h3>a) Asenna Salt (salt-minion) koneellesi.</h3>
    
    <img src="Graphics/PalvelintenHallinta/1.png" alt="" width="700" height=""/>
    <p>
        Lis√§sin paketin hallintaan tiedot mist√§ Saltin voi hakea komennoilla, jotka n√§ytettiin tunnilla.
        <br>
        Sen j√§lkeen ‚Äùsudo apt-get update‚Äù ja ‚Äùsudo apt-get install salt-minion‚Äù
        
</p>
<img src="Graphics/PalvelintenHallinta/2.png" alt="" width="700" height=""/>
<p>‚Äùsudo salt-call  - -version‚Äù Sulfur versio on asentuneen Saltista koneella.</p>
<h3>b) Viisi t√§rkeint√§. N√§yt√§ esimerkit viidest√§ t√§rkeimm√§st√§ Saltin tilafunktiosta: pkg, file, service, user, cmd. Analysoi ja selit√§ tulokset.</h3>
<img src="Graphics/PalvelintenHallinta/3.png" alt="" width="700" height=""/>
<p>
    ‚Äùsudo salt-call --local -l info state.single pkg.installed tree‚Äù
    <br>
    Paketti pit√§√§ olla asennettuna, t√§ss√§ tapauksessa tree komento asensi ohjelman, jos komennon laittaa uudestaan tuo changed=1 ei tulostu, koska mik√§√§n ei muutu tilanteessa, kun tree on jo asennettu.

</p>
<img src="Graphics/PalvelintenHallinta/4.png" alt="" width="700" height=""/>
<p>
    Loin tmp kansioon helloilkka tiedoston komennolla touch helloilkka ja sen j√§lkeen ajoin salt komennon ‚Äùsudo salt-call --local -l info state.single file.managed /tmp/helloilkka‚Äù salt l√∂ysi tiedoston ja ei tehnyt muutoksia siihen.
</p>
<img src="Graphics/PalvelintenHallinta/5.png" alt="" width="700" height=""/>
<p>
    Apache2 palvelin py√∂ri koneella, Sammutin apachen py√∂rim√§st√§ komennpolla: ‚Äúsudo salt-call --local -l info state.single service.running apache2 enable=False‚Äù  
</p>
<img src="Graphics/PalvelintenHallinta/6.png" alt="" width="700" height=""/>
<p>
    Komento ‚Äúsudo salt-call --local -l info state.single user.present ilkkah‚Äù
<br>
Tarkastaa on ilkkah k√§ytt√§j√§ kirjautuneena sis√§√§n. N√§in todellakin t√§ss√§ tapauksessa on. Ehk√§ hy√∂dyllisempi, kun on useampia orjia.
</p>
<img src="Graphics/PalvelintenHallinta/7.png" alt="" width="700" height=""/>
<p>
    sudo salt-call --local -l info state.single cmd.run 'touch /tmp/test' creates="/tmp/test"
    <br>
    Salt loi tiedoston test kansioon /tmp/   
</p>
<h3>c) Idempotentti. Anna esimerkki idempotenssista. Aja 'salt-call --local' komentoja, analysoi tulokset, selit√§ miten idempotenssi ilmenee.</h3>
<img src="Graphics/PalvelintenHallinta/8.png" alt="" width="700" height=""/>
<p>
    Udestaan komento ‚Äù sudo salt-call --local -l info state.single pkg.installed tree‚Äù
    <br>
    tree paketti oli jo asennettuna, joten tulos on idempotentti. Komennon voi ajaa usemman kerran ja tulos ei muutu.
</p>
    <h3>
    d) Tietoa koneesta. Ker√§√§ tietoja koneesta Saltin grains.items -tekniikalla. Poimi kolme kiinnostavaa kohtaa, n√§yt√§ tulokset ('grains.item osfinger virtual') ja analysoi ne.
</h3>
<p>    
T√§st√§ puuttui terokarvinen.com sivuilta ohjeet. En alkanut selvitt√§m√§√§n omatoimisesti. Muistaakseni ei tunnillakaan k√§yty l√§pi.
</p>

L√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/configuration-management-2023-autumn/#h1-viisikko">Terokarvinen.com</a>
<h1>Haaga-Helia ammattikorkeakoulu
</h1>
<h2>
Palvelinten Hallinta
</h2>
<br>
05.11.2023
<br>
<h4 id="Luento2">h2 karjaa</h4>
<h3>Host kone</h3>
<p>
<li>Prosessori: Intel i7-11700K</li>
<li>Muisti: 32Gb ddr 4</li>
<li>N√§yt√∂nohjain: 3080RTX Mobile 16Gb</li>
<li>SSD: 2tb Samsung 980 PPO NVMe, SSD2 2tb Samsung 970 EVO NVMe</li>
<li>1 N√§ytt√∂: Clevo 17,3‚Äù 4k 60Hz, 2 N√§ytt√∂: Acer Predator 43‚Äù 4k 120Hz ja 3 N√§ytt√∂: Acer Predator 24‚Äù FHD 144Hz</li>
</p>
<p>
    Cattle, not pets. 
</p>
<h3>x) Lue ja tiivist√§. (T√§ss√§ x-alakohdassa ei tarvitse tehd√§ testej√§ tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelm√§ riitt√§√§. Tiivist√§miseen riitt√§√§ muutama ranskalainen viiva.)</h3>
<h3>Slater 2017: <a href="https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets#654">What is the definition of "cattle not pets"?.</a> (Vain tuo yksi vastaus DevOps Stack Exchangen kysymykseen)</h3>
<li>Ennen serverit olivat kuin lemmikkej√§, jos serveri kaatui, piti ryhty√§ hommiin, ett√§ se saadaan takaisin yl√∂s. Nyky√§√§n servereit√§ on useampia ja toinen ottaa roolin, jos yksi kaatuu.</li>
<li>Ennen serverit olivat uniikkeja j√§rjestelmi√§, joita ihminen ohjasi. Nyky√§√§n ne ovat automatisoituja, ett√§ ihmisten tekemisi√§ ei v√§ltt√§m√§tt√§ tarvita, jos serveri kaatuu vaan automaatio hoitaa homman ja serveri palaa linjoille tai se tuhotaan. T√§m√§ ei kyll√§ ole optimia, se kannattaa mieluummin ‚Äùj√§√§dytt√§√§‚Äù ja tutkia perimm√§inen syy miksi serveri ylip√§√§t√§√§n kaatui.</li>
<h3>Karvinen 2017: <a href="https://terokarvinen.com/2017/04/11/vagrant-revisited-install-boot-new-virtual-machine-in-31-seconds/">Vagrant Revisited ‚Äì Install & Boot New Virtual Machine in 31 seconds</a> (Suosittelen koneeksi 'vagrant init debian/bullseye64')</h3>
<p>
    <li>- ‚Äúsudo apt-get update‚Äù paketin hallinnan p√§ivitys</li>
   
    <li>- ‚Äúsudo apt-get -y install vagrant‚Äù vagrantin asennus</li>
    
    <li>- ‚Äúvagrant init bento/ubuntu-16.04‚Äù ubuntun alustus vagrantille</li>
    
    <li>- ‚Äúvagrant up‚Äù koneet yl√∂s</li>
    
    <li>- ‚Äúvagrant ssh‚Äù ssh yhteys vagrantiin</li>
    
    <li>- ‚Äúvagrant destroy‚Äù koneet alas</li>    
</p>
<h3>Karvinen 2023:<a href="https://terokarvinen.com/2023/salt-vagrant/"> Salt Vagrant - automatically provision one master and two slaves</a></h3>
<li>- Artikkeli k√§sittellee Vagrantin asennusta yhdell√§ masterilla ja kahdella orjalla</li>
<li>- Artikkeli on tehty raudalla py√∂riv√§√§ linux asennusta varten, ei sovellu windowsille suoraan</li>
<li>- Artikkelia voi soveltaa Vagrantin asennukseen Windowsille</li>
<h3>a)	Asenna Vagrant. (Toiminee parhaiten is√§nt√§k√§ytt√∂j√§rjestelm√§ss√§, siis siin√§, joka py√∂rii raudalla)</h3>
<p>
    Vagrantin asennus windowsille Vmwaren kanssa osoittautui jokseenkin haastavaksi, ohjeita ei ollut paljon. Jo pitk√§√§n ollut t√§m√§ mieless√§, joten p√§√§tin asentaa Linuxin toiseksi k√§ytt√∂j√§rjestelm√§kseni p√§√§koneeseen Windowsin rinnalle. Valitsin Linuxiksi Debian 12.
    <br>
    Asensin Rufuksen Windowsille ja loin bootaavan usb tikun Debianilla
</p>
<p>
    Kirjoitan seuraavan osion ulkomuistista.
    <br>
    Debianin asennus onnistui mutta tuli grafiikka bugeja, en aluksi p√§√§ssy kirjautumaan roottina, mutta komento ‚Äùsu ‚Äì root‚Äù onnistui sen tekem√§√§n. Koitin p√§ivitt√§√§ n√§yt√∂nohjaimen ajureita, se osoittautui hankalaksi. N√§yt√∂n ohjain on Nvidia 3080 RTX mobile paketinhallinnasta niit√§ ei l√∂ytynyt. Nvidian sivuilta sain .run tiedoston, jonka muokkasin ‚Äùchmod u+x tiedostonimi‚Äù suoritetavaksi tiedostoksi kaikki t√§m√§ kun n√§ytt√∂ pomppi miten sattuu ja oli hankalaa lukea. komento ./nvidia-drivers-xxx-xxx.run. Installeri varoitti, ett√§ X-server py√∂rii ja se pit√§√§ lopettaa. Googlasin, mutta ohjeet eiv√§t auttaneet, tietokone oli ohjeiden j√§lkeen aina k√§ynnistett√§v√§ reset napilla uudestaan. Ohjeita oli esim. CTR+ALT+F1 tai ‚Äùsudo service gdm stop‚Äù Kokeilin useita muitakin metodeja ratkaista ongelma, asensin jopa kahteen kertaan koko Debianin ja lopuksi kokeilin viel√§ Ubuntua asentaa, mutta se t√∂kk√§si jo asennus vaiheessa mustaan ruuttuun. T√§h√§n kaikkeen meni aikaa yli 6 tuntia
    <br>
    P√§√§tin palata asentamaan Vagrantin Windowsille, koska Linuxin asentaminen raudalleni tuntuu olevan todella haastava homma. T√§ll√§ hetkell√§ Grubissa on pari debiania asennettuna. Mitenh√§n sen siivoaisi? üòä
    <br>
    Googlasin ohjeet vagrantin asennukseen Windows 11 ja Vmawarelle, l√∂ysin Github sivun: <a href="https://gist.github.com/1eedaegon/6a5a2ab64f09b0800eadf3f84dad96f8"> Install vagrant with vmware for windows 11 (github.com) </a>
    <br>
    Latasin ja asensin Gon (ohjelmointikieli), uudelleen asennus vaadittin
    <br>
    Skippasin kohdan 2, koska minulla oli jo Vmware asennettuna.
    <br>
    Latasin ja asensin Vagrantin VMware Utilityn.
    <br>
    Aloin asentamaan pluginia Vmwarelle, n√§iden ohjeiden mukaan: <a href="https://www.hashicorp.com/blog/introducing-the-vagrant-vmware-desktop-plugin">Introducing the Vagrant VMware Desktop Plugin (hashicorp.com)</a>
    <br>
    Pyysin lis√§√§ aikaa teht√§vien tekoon ja jatkan t√§st√§..
    <br>
    jatkoin 6.11.2023
    <br>
    Selvitin tuo Vagrant VMware Desktop Plugin on maksullinen, koitan viel√§ asentaa Ubuntun tuoreimman ei LTS version koneelleni.
    </p>
    <img src="Graphics/PalvelintenHallinta/9.png" alt="" width="700" height=""/>
    <p>
        Sain Ubuntun version 23.10 ilman ongelmia py√∂rii nyt raudan p√§√§ll√§ siis. Nyt teht√§vien pariin.
    </p>
    <h3>a) Asenna Vagrant. (Toiminee parhaiten is√§nt√§k√§ytt√∂j√§rjestelm√§ss√§, siis siin√§, joka py√∂rii raudalla) ja b) Yksi maankiert√§j√§. Asenna yksi kone Vagrantilla, ota siihen SSH-yhteys, osoita ett√§ netti toimii.
    </h3>
<p>Komento ‚Äùsudo apt-get install vagrant virtualbox‚Äù komento asensi vagrantin ja virtualboxin
    <br>
    komento alustaa Debianin version bullseye64 toimimana vagrantissa ja luo Vagranfile tiedoston, tiedostolla voi muokata asetuksia ymp√§rist√∂ss√§ ‚Äùvagrant init debian/bullseye64‚Äù

</p>
<img src="Graphics/PalvelintenHallinta/10.png" alt="" width="700" height=""/>
<p>
    Debian/bullseye64 ei l√∂ytynyt aluksi, joten vagrant latasi sen.    
</p>
<img src="Graphics/PalvelintenHallinta/11.png" alt="" width="700" height=""/>
<p>
    Synkronoidut kansiot ovat p√§√§ll√§, t√§m√§ pit√§√§ kyll√§ opetella laittamaan pois p√§√§lt√§. Komentohan tuossa onkin jo annettu valmiiksi, kun muuttaa ilmeisesti vagrantfiless√§ olevia tietoja.
</p>
<img src="Graphics/PalvelintenHallinta/12.png" alt="" width="700" height=""/>
<p>
    Komento ‚Äùvagrant ssh‚Äù ja siell√§ py√∂rii debian ja olen kirjautuneena sis√§√§n
</p>
<h3>c) Oma orjansa. Asenna Salt herra ja orja samalle koneelle.</h3>
<p>
    Teht√§v√§ pit√§isi olla paremmin avattu. Eli vagrant koneelle vai p√§√§koneelle.
    <br>
Asennan p√§√§koneelle. ‚Äùsudo apt-get update‚Äù, ‚Äùsudo apt-get install salt-minion‚Äù
<br>
eip√§ asennukkaan my√∂sk√§√§n ubuntuun. Lis√§sin paketinhallintaan n√§iden ohjeiden mukaisesti: <a href="https://docs.saltproject.io/salt/install-guide/en/latest/topics/install-by-operating-system/debian.html#install-salt-on-debian-11-bullseye-amd64">Docs.saltprojet.io</a>
</p>
<img src="Graphics/PalvelintenHallinta/13.png" alt="" width="700" height=""/>
<p>
    sitten komento uudestaan ‚Äùsudo apt-get update‚Äù ja sudo apt-get install salt-minion‚Äù ja viel√§ komento ‚Äùsudo apt-get install salt-master‚Äù, kummatkin asentuivat hienosti
</p>
<img src="Graphics/PalvelintenHallinta/14.png" alt="" width="700" height=""/>
<p>
    Yritin k√§ynnist√§√§ salt masterin ja minionin, eip√§ l√§hteneetk√§√§n k√§yntiin.
Koitin ohjeiden mukaan, vaikka ne ovatkin debianille, mutta k√§sitt√§√§kseni Ubintu on debian pohjainen distro, joten ne saattavat toimia.
<br>
Laitoin komennon ‚Äùsudo systemctl enable salt-master && systemctl start salt-master‚Äù ja ukomennon ‚Äùsudo systemctl enable salt-minion && systemctl start salt-minion‚Äù
</p>
<img src="Graphics/PalvelintenHallinta/15.png" alt="" width="700" height=""/>
<p>
komento ‚Äùps aux -e | grep salt‚Äù l√∂ytyi prosessit joita salt-minion ja salt-master k√§yttt√§. Se siis oli nyt asennettu koneelle.
</p>
<img src="Graphics/PalvelintenHallinta/16.png" alt="" width="700" height=""/>
<p>
    arkastin viel√§ saltin version komennolla ‚Äù salt-call  --version‚Äù

</p>
<h3>Asenna Saltin herra-orja arkkitehtuuri toimimaan verkon yli. (Verkko voi olla virtuaalinen verkko paikallisten virtuaalikoneiden v√§lill√§, kuten muissakin alakohdissa)</h3>
<li>‚Äùvagrant up‚Äù</li>
<li>‚Äùvagrant ssh‚Äù </li>
<li>‚Äùsudo apt-get update‚Äù </li>
<li>‚Äùsudo apt-get install curl‚Äù</li>
<li>‚Äùsudo mkdir /etc/apt/keyrings‚Äù </li>
<li>‚Äùsudo curl -fsSL -o /etc/apt/keyrings/salt-archive-keyring-2023.gpg https://repo.saltproject.io/salt/py3/debian/11/amd64/SALT-PROJECT-GPG-PUBKEY-2023.gpg‚Äù</li>
<li>‚Äùecho "deb [signed-by=/etc/apt/keyrings/salt-archive-keyring-2023.gpg arch=amd64] https://repo.saltproject.io/salt/py3/debian/11/amd64/latest bullseye main" | sudo tee /etc/apt/sources.list.d/salt.list‚Äù</li>
<li>‚Äùsudo apt-get update‚Äù</li>
<li>‚Äùsudo apt-get install salt-minion‚Äù</li>
<li>‚Äùlogout‚Äù</li>
<p>
    komento ‚Äùsudo hostname I‚Äù t√§ll√§ sai masterin ip:n selville
</p>
<img src="Graphics/PalvelintenHallinta/17.png" alt="" width="700" height=""/>
<p>
    komento ‚Äùnc -vz 192.168.178.70 4505‚Äù portiin kytekeytyminen tcp yhteydell√§ onnistui eli portti on ylip√§√§tt√§√§n auki.
</p>
<p>
    ‚Äùvagrant ssh‚Äù
    <br>
‚Äùsudo apt-get install micro‚Äù
<br>
‚Äùsudo micro etc/salt/minion‚Äù
<br>
lis√§t√§√§n tiedostoon master: 192.168.178.70
id: ilkkah
</p>
<img src="Graphics/PalvelintenHallinta/18.png" alt="" width="700" height=""/>
<p>
    ‚Äùsudo systemctl enable salt-minion && systemctl start salt-minion‚Äù
    <br>
    eip√§ antanut vagrant virtuaalikone k√§ynnist√§√§ salt-minionia
    <br>
    ‚Äùps aux -e | grep salt‚Äù
    <br>
    kyll√§ se siell√§ py√∂ri kuitenkin 
</p>
<img src="Graphics/PalvelintenHallinta/19.png" alt="" width="700" height=""/>
<p>kokeilin k√§ynnist√§√§ salt orjan uudestaan n√§iden ohjeiden mukaan: <a href="https://terokarvinen.com/2018/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/?fromSearch=salt%20master">Terokarvinen.com salt-quickstart salt master and slave on ubuntu</a>
<br>
‚Äùsudo systemctl restart salt-minion.service‚Äù
<br>
sitten ‚Äùlogout‚Äù mutta vagrant kone sanoo, ett√§ There are stopped jobs. Mitk√∂h√§n nyt sitten? :)
<br>
Googlasin ja ohjeita <a href="https://unix.stackexchange.com/questions/116959/there-are-stopped-jobs-on-bash-exit">Stackexchange.com</a>
<br>
uudestaan vaan komento ‚Äùexit‚Äù
</p>
<img src="Graphics/PalvelintenHallinta/20.png" alt="" width="700" height=""/>
<p>
    ‚Äùsudo hostname I‚Äù ei antanut mit√§√§n tulosta
    <br>
‚Äùsalt-master‚Äù v√§√§rin uudelleen k√§ynnistetty salt-master
<br>
‚Äùsudo salt-master‚Äù taas v√§√§rin uudelleen k√§ynnistetty salt-master‚Äù virhe ilmoitus, koska se py√∂rii jo. Pit√§isi k√§ynnist√§√§ udeelleen systemctl avulla
<br>
‚Äùsudo hostname -I‚Äù kuitenkin antaa nyt IP osoitteen
<br>
‚Äùsudo salt-key -A‚Äù The key glob ‚Äô*‚Äô does not match any unaccepted keys. En kyll√§ tajua miss√§ vika
<br>
K√§vin katsomassa viel√§ etc/salt/minion tiedostoa ja ip osoitteessa oli kirjoitusvirhe. Korjasin sen ja tadaa.
</p>
<img src="Graphics/PalvelintenHallinta/21.png" alt="" width="700" height=""/>
<p>
    Komento ‚Äùsudo salt-key‚Äù paljasti, ett√§ orjaoli ilmoittautunut.
    <br>
Komento ‚Äùsudo salt-ket -A‚Äù hyv√§ksyin vaimen.
</p>
<img src="Graphics/PalvelintenHallinta/22.png" alt="" width="700" height=""/>
<p>
    Ja testaus, ett√§ orja vastaa ja toimi.
</p>
L√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/configuration-management-2023-autumn/#h1-viisikko">Terokarvinen.com</a>
<h1>Haaga-Helia ammattikorkeakoulu
</h1>
<h2>
Palvelinten Hallinta
</h2>
<br>
12.11.2023
<br>
<h4 id="Luento3">h3 Versio</h4>
<h3>a)	Online. Tee uusi varasto GitHubiin (tai Gitlabiin tai mihin vain vastaavaan palveluun). Varaston nimess√§ ja lyhyess√§ kuvauksessa tulee olla sana "winter". Aiemmin tehty varasto ei kelpaa. (Muista tehd√§ varastoon tiedostoja luomisvaiheessa, esim README.md ja GNU General Public License 3) ja b)	Dolly. Kloonaa edellisess√§ kohdassa tehty uusi varasto itsellesi, tee muutoksia, puske ne palvelimelle, ja n√§yt√§, ett√§ ne ilmestyv√§t weppiliittym√§√§n.</h3>
<img src="Graphics/PalvelintenHallinta/23.png" alt="" width="700" height=""/>
<p>
    Loin repositorion Github nettisivuilla, en luonut viel√§ ssh avainta. katsoin miten t√§m√§ toimii.
    <br>
komennolla ‚Äùgit clone repostorion osoite.git‚Äù sain kopioitua repositorion koneelle. Githubissa laitoin repostitorion publiciksi ja loin read.me tiedoston ja kirjoitin siihen hieman teksti√§.
<br>
Homma ei toiminut, kysyi k√§ytt√§j√§tunnusta ja salasanaa ja niill√§ en p√§√§ssyt sis√§√§n.
<br>
Loin komennolla ‚Äùssh-keygen‚Äù Enter Enter ssh avaimen ja kopioin sen Githubin ssh avaimiin sen j√§lkeen poistin virtuaalikoneelta tuon kansion ja kloonasin sen uudestaan.
</p>
<img src="Graphics/PalvelintenHallinta/24.png" alt="" width="700" height=""/>
<p>
    Muokkasin microlla README.md tiedostoa ja lis√§sin tekstin testi.
    <br>
    Komento ‚Äùgit add README.md‚Äù
    <br>
    Komento ‚Äúgit commit -m ‚Äúteksti√§‚Ä¶‚Äù
    <br>
    ja komento ‚Äùgit push‚Äù
</p>
    <img src="Graphics/PalvelintenHallinta/25.png" alt="" width="700" height=""/> 
    <p>
        Repositorio oli p√§ivittynyt Githubiin
    </p>
    <h3>
        c)	Doh! Tee tyhm√§ muutos gittiin, √§l√§ tee commit:tia. Tuhoa huonot muutokset ‚Äògit reset --hard‚Äô. Huomaa, ett√§ t√§ss√§ toiminnossa ei ole peruutusnappia.
        </h3>
        <p>
            Lis√§sin teksti√§ ‚Äùtyhm√§ muutos‚Äù REDME.md tiedostoon
        </p>
        <img src="Graphics/PalvelintenHallinta/26.png" alt="" width="700" height=""/>
        <p>
            komento ‚Äùgit add README.md‚Äù Komento ‚Äúgit reset ‚Äìhard‚Äù
            <br>
        
Git palautti version aikaisempaan

        </p>
        <h3>d)	Tukki. Tarkastele ja selit√§ varastosi lokia. Tarkista, ett√§ nimesi ja s√§hk√∂postiosoitteesi n√§kyy haluamallasi tavalla ja korjaa tarvittaessa.</h3>
        <img src="Graphics/PalvelintenHallinta/27.png" alt="" width="700" height=""/>
        <p>
            Author commitin tekij√§
            <br>
            Date pvm ja kellonaika, aikavy√∂hyke
            <br>
            commitin sis√§lt√∂
              
        </p>
        L√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/configuration-management-2023-autumn/#h3-versio">Terokarvinen.com</a>
        <h1>Haaga-Helia ammattikorkeakoulu
        </h1>
        <h2>
        Palvelinten Hallinta
        </h2>
        <br>
        17.11.2023
        <br>
        <h4 id="Luento4">h4 Demonit</h4>
        <h3>x) Lue ja tiivist√§. (T√§ss√§ x-alakohdassa ei tarvitse tehd√§ testej√§ tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelm√§ riitt√§√§. Tiivist√§miseen riitt√§√§ muutama ranskalainen viiva.)</h3>
       <h3>Karvinen 2023:<a href="https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file">Salt Vagrant - automatically provision one master and two slaves</a> 
            </h3>
            <h3>Infra as Code - Your wishes as a text file</h3>
            
                <li>"sudo mkdir -p /srv/salt/hello"</li>
                <li>"sudoedit /srv/salt/hello/init.sls"</li>
                <li>Sisennys on kaksi v√§lily√∂nti√§ YAML syntaksissa</li>
                <li>‚Äúcat /srv/salt/hello/init.sls‚Äù</li>
<p>
---------
<br>
/tmp/infra-as-code:
<br>
  file.managed
  <br>
---------

</p>
<li>‚Äúsudo salt '*' state.apply hello‚Äù</li>
<h3>top.sls - What Slave Runs What States</h3>
<li>top.sls m√§√§rittelee mit√§ tiloja orjille ajetaan</li>
<li>‚Äùcat /srv/salt/top.sls‚Äù</li>
<p>
----------
<br>
base:
<br>
  ‚Äò*‚Äô:
  <br>
    - hello
    <br>
----------
</p>
<li>komento: ‚Äúsudo salt ‚Äò*‚Äô state.apply</li>
<h3>Salt contributors: <a href="https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml">Salt overview, kohdat</a></h3>
<h3>Rules of YAML</h3>
<li>Koodi j√§rjestell√§√§n avain: arvo pareina.</li>
<li>Mappaus k√§ytt√§√§ kaksoispistett√§ ja yksi v√§lily√∂nti ‚Äù: ‚Äù merkit√§kseen avain: arvo parit. </li>
<li>Avainten arvot voivat olla monessa erilaisessa rakenteessa.</li>
<li>Isot ja pienet kirjaimet vaikuttavat avaimissa ja ominaisuuksissa.</li>
<li>Tabulaattoria ei k√§ytet√§, vain v√§lily√∂nti√§.</li>
<li>Kommentointi alkaa ‚Äù#‚Äù.</li>
<h3>YAML simple structure</h3>
<li>1. Skaalaajat: avain: arvo mappaukset, jossa arvo voi olla merkkijono, numero tai boolean operaattori</li>
<li>2. Listat: avain, jota seuraa lista arvoja omalla rivill√§√§ kahden v√§lily√∂nnin ja vii-van kanssa</li>
<li>3. Sanakirjat: kokoelma avainten arvo mappauksia ja listoja</li>
<h3>Lists and dictionaries - YAML block structures</h3>
<li>YAML on j√§rjestelty lohko rakenteiksi</li>
<li>    Sisennys m√§√§r√§√§ kontekstin. On pakko sisent√§√§ ominaisuudet ja listat yhdell√§ tai useammalla v√§lily√∂nnill√§. Kaksi v√§lily√∂nti√§ on standardi.
    </li>
    <h3>Salt contributors: <a href="https://docs.saltproject.io/salt/user-guide/en/latest/topics/states.html#state-modules">Salt states</a> </h3>
<h3>State modules</h3>
<li>Konflikteja voi esiinty√§</li>
<li>moduuleilla ei ole ‚Äùstatus check‚Äù mahdollisuutta, vaan t√§ytyy kutsua orjaa selvitt√§√§kseen statuksen</li>
<h3>The state SLS data structure</h3>
<li>Identifier tunniste</li>
<li>State modulin nimi</li>
<li>Function jota kutsutaan, kuten installed</li>
<li>Name tilan nimi kutsu, yleens√§ tiedoston nimi</li>
<li>Arguments parametrit joita, funktio hyv√§ksyy</li>
<h3>Organizing states</h3>
<li>Salt tilojen puu pit√§isi kirjoittaa niin, ett√§ toinen kehitt√§j√§ helposti n√§kee tilan tarkoituksen ja n√§kee kokopuun ‚Äùworkflown‚Äù</li>
<li>hyv√§ k√§yt√§nt√∂ on, ett√§ ei luo liikaa pesi√§ polkuun, vain pari tasoa. N√§in puu on helpommin navigoitavissa ja ongelmia tulee v√§hemm√§n tulevaisuudessa.</li>
<h3>The top.sls file</h3>
<li>Koska joissain ymp√§rist√∂ss√§ on satoja tiedostoja kohdistuen orjiin, ei ole k√§y-t√§nn√∂llist√§ ajaa jokainen tilaa yksitellen. t√§h√§n auttaa top.sls tiedosto</li>
<li>top.sls tiedosto kartoittaa mit√§ orjien tulisi noutaa tietyist√§ ym
    p√§rist√∂ist√§
    </li>
<li>top.sls m√§√§ritt√§√§ mit√§ tiloja tulisi suorittaa noista ymp√§rist√∂ist√§</li>
<h3>Create the SSH state, Create the Apache state</h3>
<li>Eli t√§nne pit√§isi laittaa name kohdan tilalle muttuja,  tiedosto on sitten my√∂s au-tomatisoitu toimimaan paremmin uudelleen k√§ytett√§ess√§?</li>
<li>
    Apache state, apachen uudellen k√§ynnistyksen kohdalla sanoisin, ett√§ .conf tiedosto tulee k√§ytt√∂√∂n, voisi olla hy√∂dyllist√§ k√§ynnist√§√§ demoni uudestaan service-watchin avulla, joka seuraa .conf tiedostoa. En kyll√§ tied√§ miten t√§m√§ toteutetaan. 
    </li>
<h3>Karvinen 2018: <a href="https://terokarvinen.com/2018/04/03/pkg-file-service-control-daemons-with-salt-change-ssh-server-port/?fromSearch=karvinen%20salt%20ssh">Pkg-File-Service ‚Äì Control Daemons with Salt ‚Äì Change SSH Server Port</a> </h3>
<p>
    Artikkeli k√§sittelee demonien ohjausta Saltilla ja kuinka vaihtaa SSH serveriin alterna-tiivinen portti
</p>
<h3>a) Hello SLS! Tee Hei maailma -tila kirjoittamalla se tekstitiedostoon, esim /srv/salt/hello/init.sls.</h3>

On ollut v√§h√§n kiire viikko, valitettavasti en ehtinyt tekem√§√§n n√§it√§ teht√§vi√§, luin kuitenkin teorian. Koitan palata n√§ihin teht√§viin viel√§ huomenna. 20.11.2023

<h3>b) Top. Tee top.sls niin, ett√§ tilat ajetaan automaattisesti, esim komennolla "sudo salt '*' state.apply".</h3>
<h3>‚Ä¢	c) Apache. Asenna Apache, korvaa sen testisivu ja varmista, ett√§ demoni k√§ynnistyy.
    <li>	Ensin k√§sin, vasta sitten automaattisesti.</li>
    <li>Kirjoita tila sls-tiedostoon.</li>
        <li>pkg-file-service</li>
            <li>T√§ss√§ ei tarvita service:ss√§ watch, koska index.html ei ole asetustiedosto</li>
    </h3>
    <h3>d) SSHouto. Lis√§√§ uusi portti, jossa SSHd kuuntelee.
        
        </h3>
        <p>
        L√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/configuration-management-2023-autumn/#h4-demonit">Terokarvinen.com</a>
        </p>
        <h1>Haaga-Helia ammattikorkeakoulu
        </h1>
        <h2>
        Palvelinten Hallinta
        </h2>
        <br>
        26.11.2023
        <br>
        <h4 id="Luento5">h5 CSI Kerava</h4>
        <h3>x) Lue ja tiivist√§. (T√§ss√§ x-alakohdassa ei tarvitse tehd√§ testej√§ tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelm√§ riitt√§√§. Tiivist√§miseen riitt√§√§ muutama ranskalainen viiva.)</h3>
            <h3>Karvinen 2018: <a href="https://terokarvinen.com/2018/04/03/apache-user-homepages-automatically-salt-package-file-service-example/">Apache User Homepages Automatically ‚Äì Salt Package-File-Service Example</a></h3>
            <li>"sudo find -printf '%T+ M %p\n%A+ A %p\n%C+ C %p\n'|sort"</li>
            <li>find -printf "%T+ %p\n"|sort</li>
            <li>Artikkelissa esitell√§√§n kaksi eri tapaa, nopea cmd ja parempi tapa, jossa ei tarvitse suorittaa shell komnentoja.</li>
            <h3>a) CSI Kerava. N√§yt√§ 'find' avulla viimeisimm√§ksi muokatut tiedostot /etc/-hakemistosta ja kotihakemistostasi. Selit√§ kaikki k√§ytt√§m√§si parametrit ja format string 'man find' avulla.</h3>
            <img src="Graphics/PalvelintenHallinta/28.png" alt="" width="700" height=""/>
            <p>
                Apachen hakemistossa komento ‚Äù find -printf '%T+ %p\n'‚Äù n√§ytt√§√§ tiedostot ja niiden muokkausajat. \n vaihtaa rivi√§.
            </p>
<img src="Graphics/PalvelintenHallinta/29.png" alt="" width="700" height=""/>
<p>
    Kotihakemistossa komento ‚Äù find -printf '%T+ %p\n'‚Äù
</p>
<h3>b) Gui2fs. Muokkaa asetuksia jostain graafisen k√§ytt√∂liittym√§n (GUI) ohjelmasta k√§yt-t√§en ohjelman valikoita ja dialogeja. Etsi t√§m√§ asetus tiedostoj√§rjestelm√§st√§.</h3>
<p>Vaihdoin Firefoxin alku sivun ‚Äùhttp://www.heusala.fi/HH/PalvelintenHallinta.html‚Äù
    <br>
    Mutta en l√∂yt√§nyt etc/firefoxi-esr hakemistosta mit√§√§n tiedostoa mit√§ olisi muokattu. Kokeilin my√∂s etsi√§ tiedostoa ‚Äùfind -printf '%T+ %p\n' | sort‚Äù mutta ei l√∂ytynyt.
    <br>
    Kokeilin viel√§ vaihtaa fonttien asetuksia Libreofficesta, mutta en l√∂yt√§nyt n√§it√§k√§√§n. Libreofficen hakemistossa suoritin komennon ‚Äùfind -printf '%T+ %p\n' | sort‚Äù
    <br>   
    Kokeilin juurihakemistossakin tehd√§ komentoa ‚Äù find -printf '%T+ %p\n' | sort‚Äù mutta tuli liikaa tiedostoja ja en alkanut sielt√§ etsim√§√§n, kun pari viimeist√§ vaihtoehtoa ei ollut sopivia.
    </p>
<h3>c) Komennus. Tee Salt-tila, joka asentaa j√§rjestelm√§√§n uuden komennon.</h3>
    <p>Loin tiedoston hello tiedoston srv/salt/hello/ kansioon sis√§ll√∂ll√§:</p>
    <img src="Graphics/PalvelintenHallinta/30.png" alt="" width="700" height=""/>
    <p>Loin init.sls tiedoston samaan kansioon sis√§ll√∂ll√§:</p>
    <img src="Graphics/PalvelintenHallinta/31.png" alt="" width="700" height=""/>
    <img src="Graphics/PalvelintenHallinta/32.png" alt="" width="700" height=""/>
    <p>komento ‚Äùsudo salt-call --local state.apply hello‚Äù N√§kyi ett√§ uusi tiedosto oli luotu.</p>
<img src="Graphics/PalvelintenHallinta/33.png" alt="" width="700" height=""/>
<p>K√§vin viel√§ katsomassa usr/local/bin hakemistosta, ett√§ tiedosto oli luotu sinne ja mit√§ se sis√§lsi. koitin viel√§, mit√§ k√§y kun kirjoitaa miss√§ tahansa hakemistossa hello. Se suoritti tuon ohjelman, joka tulostaa sanan Hello ja p√§iv√§m√§√§r√§n, ajan ja aikavy√∂hykkeen.</p>
<h3>d) Apassi. Tee Salt-tila, joka asentaa Apachen n√§ytt√§m√§√§n kotihakemistoja.</h3>
<img src="Graphics/PalvelintenHallinta/34.png" alt="" width="700" height=""/>
    <p>Olen m√∂kill√§ ja j√§√§tyi putket, hitto. Pit√§√§ l√§hte√§ naapuriin saunomaan, teen t√§m√§n my√∂hemmin.</p>
<h3>e) √Ñmp√§rillinen. Tee Salt-tila, joka asentaa j√§rjestelm√§√§n kansiollisen komentoja.</h3>
<p>tein kansion ‚Äùsudo mkdir -p kansiollinenkomentoja‚Äù srv/salt/ kansioon.
    <br>
    Kopion kansioon aikaisemmin luomani hello tiedoston ja loin uuden tiedoston pyyttoni.py alla olevalla sis√§l√∂ll√§:
    </p>
<img src="Graphics/PalvelintenHallinta/35.png" alt="" width="700" height=""/>
<p>sitten komento ‚Äùsudoedit init.sls‚Äù</p>
<img src="Graphics/PalvelintenHallinta/36.png" alt="" width="700" height=""/>
<p>Muuten sama sis√§lt√∂ tiedostossa kuin hello kansiossa, mutta lis√§sin siihen uuden kohdan pyyttoni.py tiedostoa varten. ja muutin kummankin tiedoston polut vastamaan kansiorakennettani.</p>
<img src="Graphics/PalvelintenHallinta/37.png" alt="" width="700" height=""/>
<p>Komento ‚Äùsudo salt-call --local state.apply hello‚Äù n√§kyi, ett√§ yksi tiedosto oli muuttunut ja se oli pyyttoni.py, koska hello tiedosto l√∂ytyi jo usr/local/bin kansiosta.</p>
<img src="Graphics/PalvelintenHallinta/38.png" alt="" width="700" height=""/>
<p>ajoin viel√§ pyyttoni.py komennon</p>
<p>
    L√§hteen√§ on k√§ytetty: <a href="https://terokarvinen.com/2023/configuration-management-2023-autumn/">Terokarvinen.com</a>
</p>


</body>
</html>
